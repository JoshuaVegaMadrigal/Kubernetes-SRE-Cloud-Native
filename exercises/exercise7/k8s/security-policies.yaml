---
# Pod Security Standards (replacement for deprecated PSP)
apiVersion: v1
kind: Namespace
metadata:
  name: default
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
    security.hardened: "true"

---
# Security Context Constraints for production workloads
apiVersion: v1
kind: ConfigMap
metadata:
  name: pod-security-policy
  namespace: default
  labels:
    security.hardened: "true"
data:
  security-standards.yaml: |
    # Pod Security Standards configuration
    # This replaces the deprecated PodSecurityPolicy
    
    enforced_standards:
      - no_root_containers: true
      - read_only_root_filesystem: true
      - no_privilege_escalation: true
      - drop_all_capabilities: true
      - secure_volumes_only: true
    
    allowed_volume_types:
      - configMap
      - emptyDir
      - projected
      - secret
      - downwardAPI
      - persistentVolumeClaim
    
    security_context_requirements:
      run_as_non_root: true
      read_only_root_filesystem: true
      allow_privilege_escalation: false
      required_drop_capabilities:
        - ALL